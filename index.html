<!DOCTYPE html>
<html lang="pt-BR" class="">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auxiliar de Evolução Médica</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        /* Definindo variáveis CSS para cores Material Design - Tema Claro */
        :root {
            --md-primary: #1976D2; /* Azul Material escuro */
            --md-primary-light: #2196F3; /* Azul Material */
            --md-primary-dark: #1565C0; /* Azul Material mais escuro */
            --md-secondary: #00BCD4; /* Ciano Material */
            --md-surface: #FFFFFF;
            --md-background: #F5F5F5; /* Cinza claro Material */
            --md-on-surface: rgba(0, 0, 0, 0.87); /* Cor de texto principal */
            --md-on-background: rgba(0, 0, 0, 0.87);
            --md-on-primary: #FFFFFF;
            --md-text-secondary: rgba(0, 0, 0, 0.60);
            --md-divider: rgba(0, 0, 0, 0.12);
        }

        /* Definindo variáveis para o tema escuro */
        html.dark {
            --md-primary: #BB86FC; /* Roxo Material Dark */
            --md-primary-light: #985EFF;
            --md-primary-dark: #3700B3;
            --md-secondary: #03DAC6; /* Ciano Material Dark */
            --md-surface: #1E1E1E; /* Cinza escuro para cards */
            --md-background: #121212; /* Fundo principal escuro */
            --md-on-surface: rgba(255, 255, 255, 0.87); /* Texto principal claro */
            --md-on-background: rgba(255, 255, 255, 0.87);
            --md-on-primary: #000000;
            --md-text-secondary: rgba(255, 255, 255, 0.60); /* Texto secundário claro */
            --md-divider: rgba(255, 255, 255, 0.12); /* Divisor claro */
        }

        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--md-background);
            color: var(--md-on-background);
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        .container {
            max-width: 1024px;
        }
        /* Estilos para o Accordion */
        .accordion-header, .js-accordion-header {
            transition: background-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        html.dark .accordion-header:hover, html.dark .js-accordion-header:hover {
             background-color: rgba(255, 255, 255, 0.05);
        }
        .accordion-content {
            transition: max-height 0.3s ease-out;
            overflow: hidden;
            border-color: var(--md-divider);
        }
        .chevron-icon {
            transition: transform 0.3s ease-in-out;
        }
        .rotate-180 {
            transform: rotate(180deg);
        }
        /* Foco aprimorado para inputs (Material-like) */
        .form-input, .form-textarea, .form-select {
            border: none;
            border-bottom: 1px solid var(--md-divider);
            padding-left: 0.25rem;
            padding-right: 0.25rem;
            padding-top: 0.5rem;
            padding-bottom: 0.5rem;
            background-color: transparent;
            color: var(--md-on-background);
            transition: border-bottom-color 0.2s ease-in-out;
        }
        .form-input:focus, .form-textarea:focus, .form-select:focus {
            outline: none;
            border-bottom-color: var(--md-primary-light);
            box-shadow: 0 1px 0 0 var(--md-primary-light);
        }
        html.dark .form-input:focus,
        html.dark .form-textarea:focus,
        html.dark .form-select:focus {
             border-bottom-color: var(--md-secondary);
             box-shadow: 0 1px 0 0 var(--md-secondary);
        }

        /* Correção para opções de select no tema escuro */
        html.dark .form-select option {
            background-color: var(--md-surface);
            color: var(--md-on-background);
        }

        .form-checkbox {
            accent-color: var(--md-primary-light);
            margin-right: 0.5rem;
        }
        html.dark .form-checkbox {
             accent-color: var(--md-secondary);
        }
        .subsection-title {
            font-size: 1.125rem;
            font-weight: 500;
            color: var(--md-on-surface);
            padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--md-divider);
            margin-bottom: 1.5rem;
        }
        .grid-container {
            display: grid;
            gap: 1.5rem;
        }
        @media (min-width: 768px) { .grid-container { grid-template-columns: repeat(2, 1fr); } }
        @media (min-width: 1024px) { .grid-container { grid-template-columns: repeat(3, 1fr); } }

        html.dark .bg-gray-50 {
             background-color: rgba(255, 255, 255, 0.05);
        }

        /* Estilos Material para Cards e Elevado */
        .md-card {
            background-color: var(--md-surface);
            border-radius: 8px;
            box-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),
                          0px 4px 5px 0px rgba(0,0,0,0.14),
                          0px 1px 10px 0px rgba(0,0,0,0.12);
            transition: background-color 0.3s ease;
        }
        .md-card-elevated {
            box-shadow: 0px 5px 5px -3px rgba(0,0,0,0.2),
                          0px 8px 10px 1px rgba(0,0,0,0.14),
                          0px 3px 14px 2px rgba(0,0,0,0.12);
        }
        .md-button {
            background-color: var(--md-primary-light);
            color: var(--md-on-primary);
            border-radius: 4px;
            transition: background-color 0.2s, box-shadow 0.2s;
        }
        .md-button:hover {
            background-color: var(--md-primary-dark);
            box-shadow: 0px 3px 5px -1px rgba(0,0,0,0.2),
                          0px 6px 10px 0px rgba(0,0,0,0.14),
                          0px 1px 18px 0px rgba(0,0,0,0.12);
        }
        .md-button:active { transform: scale(0.98); }

        /* Cores de texto */
        .text-primary { color: var(--md-on-background); }
        .text-secondary { color: var(--md-text-secondary); }
        .text-blue-500 { color: var(--md-primary-light) !important; }
        .bg-blue-500 { background-color: var(--md-primary-light) !important; }
        .hover\:bg-blue-600:hover { background-color: var(--md-primary-dark) !important; }
        .focus\:ring-blue-500:focus { --tw-ring-color: var(--md-primary-light) !important; }
        html.dark .focus\:ring-blue-500:focus { --tw-ring-color: var(--md-secondary) !important; }
        html.dark .focus\:ring-offset-2:focus { --tw-ring-offset-color: var(--md-background) !important; }
    </style>
</head>
<body class="p-4 md:p-8">
    <div class="container mx-auto space-y-6 md:space-y-8">
        <header class="mb-4 flex justify-between items-center p-2">
            <div class="text-center flex-grow">
                <h1 class="text-3xl md:text-4xl font-bold text-primary">Auxiliar de Evolução Médica</h1>
                <p class="text-base md:text-lg text-secondary mt-1">Criado com ❤️ por @caiodeag</p>
            </div>
            <button id="theme-toggle" class="p-2 rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500" aria-label="Toggle dark mode">
                <i class="fas fa-moon text-xl text-secondary"></i>
            </button>
        </header>
        <main id="evolution-form" class="md-card p-4 md:p-8 space-y-4">
            <div id="accordion-container" class="space-y-4">

                <div class="md-card">
                    <button class="js-accordion-header accordion-header w-full flex justify-between items-center p-4 md:p-5 text-left bg-md-surface hover:bg-gray-100 dark:hover:bg-opacity-5 rounded-lg" aria-expanded="false">
                        <div class="flex items-center space-x-4">
                            <i class="fas fa-user-md text-xl text-blue-500"></i>
                            <h2 class="text-lg md:text-xl font-medium text-primary">1. Situação Geral e Anamnese</h2>
                        </div>
                        <i class="fas fa-chevron-down chevron-icon text-secondary"></i>
                    </button>
                    <div class="accordion-content p-4 md:p-6 border-t hidden">
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            <div>
                                <label class="font-medium text-secondary">Setor:</label>
                                <input type="text" id="setor" placeholder="Ex: CTI, Enfermaria" class="form-input w-full mt-1">
                            </div>
                            <div>
                                <label class="font-medium text-secondary">Leito:</label>
                                <input type="text" id="leito" placeholder="Ex: CTI 3" class="form-input w-full mt-1">
                            </div>
                            <div>
                                <label class="font-medium text-secondary">Evolução Clínica:</label>
                                <select id="evolucao-clinica" class="form-select w-full mt-1">
                                    <option value="">-- Selecione --</option>
                                    <option value="Estável">Estável</option>
                                    <option value="Mantém o Quadro">Mantém o Quadro</option>
                                    <option value="Melhora Clínica">Melhora Clínica</option>
                                    <option value="Piora Clínica">Piora Clínica</option>
                                    <option value="Instável">Instável</option>
                                </select>
                            </div>
                            <div>
                                <label class="font-medium text-secondary">Evolução Hemodinâmica:</label>
                                <select id="evolucao-hemo" class="form-select w-full mt-1">
                                    <option value="">-- Selecione --</option>
                                    <option value="Estável">Estável</option>
                                    <option value="Instável">Instável</option>
                                </select>
                            </div>
                            <div>
                                <label class="font-medium text-secondary">Estado Geral:</label>
                                <select id="estado-geral" class="form-select w-full mt-1">
                                    <option value="">-- Selecione --</option>
                                    <option value="Bom">Bom</option>
                                    <option value="Regular">Regular</option>
                                    <option value="Ruim">Ruim</option>
                                    <option value="Grave">Grave</option>
                                </select>
                            </div>
                            <div>
                                <label class="font-medium text-secondary">Queixas nas 24h:</label>
                                <select id="queixas" class="form-select w-full mt-1">
                                    <option value="">-- Selecione --</option>
                                    <option value="Sim">Sim</option>
                                    <option value="Não">Não</option>
                                </select>
                            </div>
                            <div id="queixas-obs-container" class="col-span-full hidden">
                                <label class="font-medium text-secondary">Descrição das queixas:</label>
                                <textarea id="queixas-obs" rows="1" class="form-textarea w-full mt-1" placeholder="Ex: Refere dor abdominal em cólica"></textarea>
                            </div>
                             <div class="col-span-full grid grid-cols-2 lg:grid-cols-4 gap-6">
                                <div class="form-group-flex">
                                    <label class="font-medium text-secondary">Distermias:</label>
                                    <select id="distermias" class="form-select flex-1">
                                        <option value="">-- Sel --</option>
                                        <option value="Sim">Sim</option>
                                        <option value="Não">Não</option>
                                    </select>
                                </div>
                                <div class="form-group-flex">
                                    <label class="font-medium text-secondary">Disglicemias:</label>
                                    <select id="disglicemias" class="form-select flex-1">
                                        <option value="">-- Sel --</option>
                                        <option value="Sim">Sim</option>
                                        <option value="Não">Não</option>
                                    </select>
                                </div>
                                <div class="form-group-flex">
                                    <label class="font-medium text-secondary">Alt. de PA:</label>
                                    <select id="alt-pa" class="form-select flex-1">
                                        <option value="">-- Sel --</option>
                                        <option value="Sim">Sim</option>
                                        <option value="Não">Não</option>
                                    </select>
                                </div>
                                <div class="form-group-flex">
                                    <label class="font-medium text-secondary">Alterações Lab:</label>
                                    <select id="alt-lab" class="form-select flex-1">
                                        <option value="">-- Sel --</option>
                                        <option value="Sim">Sim</option>
                                        <option value="Não">Não</option>
                                    </select>
                                </div>
                            </div>
                             <div class="col-span-full mt-2">
                                <label class="font-medium text-secondary">Observações gerais (Anamnese):</label>
                                <textarea id="obs-gerais" rows="2" class="form-textarea w-full mt-1" placeholder="Ex: Paciente em oxigenoterapia por cateter nasal"></textarea>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="md-card">
                    <button class="js-accordion-header accordion-header w-full flex justify-between items-center p-4 md:p-5 text-left bg-md-surface hover:bg-gray-100 dark:hover:bg-opacity-5 rounded-lg" aria-expanded="false">
                        <div class="flex items-center space-x-4">
                            <i class="fas fa-heart-pulse text-xl text-blue-500"></i>
                            <h2 class="text-lg md:text-xl font-medium text-primary">2. Parâmetros Vitais e Suporte</h2>
                        </div>
                        <i class="fas fa-chevron-down chevron-icon text-secondary"></i>
                    </button>
                    <div class="accordion-content border-t hidden">
                        <div>
                            <button class="js-accordion-header w-full flex justify-between items-center text-left p-4" aria-expanded="false">
                                <span class="text-lg font-medium text-primary">Parâmetros Atuais</span>
                                <i class="fas fa-chevron-down chevron-icon text-secondary"></i>
                            </button>
                            <div class="accordion-content hidden p-4 border-t border-[var(--md-divider)]">
                                <div class="grid-container">
                                    <div>
                                        <label class="font-medium text-secondary">PA:</label>
                                        <input type="text" id="pa" placeholder="mmHg" class="form-input w-full mt-1">
                                    </div>
                                    <div>
                                        <label class="font-medium text-secondary">FC:</label>
                                        <input type="text" id="fc" placeholder="bpm" class="form-input w-full mt-1">
                                    </div>
                                    <div>
                                        <label class="font-medium text-secondary">FR:</label>
                                        <input type="text" id="fr" placeholder="irpm" class="form-input w-full mt-1">
                                    </div>
                                    <div>
                                        <label class="font-medium text-secondary">Temp:</label>
                                        <input type="text" id="temp" placeholder="°C" class="form-input w-full mt-1">
                                    </div>
                                    <div>
                                        <label class="font-medium text-secondary">SatO₂:</label>
                                        <input type="text" id="sato2" placeholder="%" class="form-input w-full mt-1">
                                    </div>
                                    <div>
                                        <label class="font-medium text-secondary">Dor (Escala 1-10):</label>
                                        <input type="text" id="dor-escala" placeholder="0 a 10" class="form-input w-full mt-1">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="border-t border-[var(--md-divider)]">
                            <button class="js-accordion-header w-full flex justify-between items-center text-left p-4" aria-expanded="false">
                                <span class="text-lg font-medium text-primary">Suporte e Balanço</span>
                                <i class="fas fa-chevron-down chevron-icon text-secondary"></i>
                            </button>
                            <div class="accordion-content hidden p-4 border-t border-[var(--md-divider)]">
                                <div class="grid-container">
                                    <div>
                                        <label class="font-medium text-secondary">Ventilação:</label>
                                        <select id="suporte-vent" class="form-select w-full mt-1">
                                            <option value="">-- Selecione --</option>
                                            <option value="Ar Ambiente">Ar Ambiente</option>
                                            <option value="Cateter Nasal">Cateter Nasal</option>
                                            <option value="Máscara de O2">Máscara de O2</option>
                                            <option value="Máscara com Reservatório">Máscara com Reservatório</option>
                                            <option value="VNI">VNI</option>
                                            <option value="VM">VM</option>
                                            <option value="outro">Outro</option>
                                        </select>
                                    </div>
                                    <div id="suporte-vent-outro-container" class="hidden">
                                        <label class="font-medium text-secondary">Detalhes:</label>
                                        <input type="text" id="suporte-vent-outro" class="form-input w-full mt-1" placeholder="Detalhe do suporte ventilatório (outro)">
                                    </div>
                                    <div id="vm-parameters-container" class="col-span-full hidden grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-4 p-4 md-card bg-gray-50">
                                        <h4 class="col-span-full text-lg font-semibold text-primary mb-2">Parâmetros de Ventilação Mecânica</h4>
                                        <div>
                                            <label class="font-medium text-secondary">Modo VM:</label>
                                            <input type="text" id="vm-modo" placeholder="Ex: VCV, PCV, PSV" class="form-input w-full mt-1">
                                        </div>
                                        <div>
                                            <label class="font-medium text-secondary">FiO₂:</label>
                                            <input type="text" id="vm-fio2" placeholder="%" class="form-input w-full mt-1">
                                        </div>
                                        <div>
                                            <label class="font-medium text-secondary">PEEP:</label>
                                            <input type="text" id="vm-peep" placeholder="cmH₂O" class="form-input w-full mt-1">
                                        </div>
                                        <div>
                                            <label class="font-medium text-secondary">FR (Ventilador):</label>
                                            <input type="text" id="vm-fr" placeholder="irpm" class="form-input w-full mt-1">
                                        </div>
                                        <div>
                                            <label class="font-medium text-secondary">Pressão de Pico (Pva):</label>
                                            <input type="text" id="vm-pva" placeholder="cmH₂O" class="form-input w-full mt-1">
                                        </div>
                                        <div>
                                            <label class="font-medium text-secondary">Volume Corrente (VT):</label>
                                            <input type="text" id="vm-tidal-vol" placeholder="mL" class="form-input w-full mt-1">
                                        </div>
                                        <div class="col-span-full">
                                            <label class="font-medium text-secondary">Outros Parâmetros VM:</label>
                                            <textarea id="vm-outros-params" rows="1" class="form-textarea w-full mt-1" placeholder="Ex: Plateau, I:E, Fluxo"></textarea>
                                        </div>
                                    </div>
                                    <div>
                                        <label class="font-medium text-secondary">Uso de DVA:</label>
                                        <select id="dva" class="form-select w-full mt-1">
                                            <option value="">-- Selecione --</option>
                                            <option value="Sim">Sim</option>
                                            <option value="Não">Não</option>
                                        </select>
                                    </div>
                                    <div id="dva-obs-container" class="col-span-full hidden">
                                        <label class="font-medium text-secondary">Detalhes DVA:</label>
                                        <input type="text" id="dva-obs" placeholder="Ex: Noradrenalina 5 mcg/min" class="form-input w-full mt-1">
                                    </div>
                                    <div>
                                        <label class="font-medium text-secondary">Dieta (Via):</label>
                                        <select id="dieta-tipo" class="form-select w-full mt-1">
                                            <option value="">-- Selecione --</option>
                                            <option value="Oral">Oral</option>
                                            <option value="Enteral">Enteral</option>
                                            <option value="Parenteral">Parenteral</option>
                                            <option value="Jejum">Jejum</option>
                                            <option value="outro">Outro</option>
                                        </select>
                                    </div>
                                    <div id="dieta-tipo-outro-container" class="hidden">
                                        <label class="font-medium text-secondary">Detalhes (Dieta - Outro):</label>
                                        <input type="text" id="dieta-tipo-outro" class="form-input w-full mt-1" placeholder="Detalhe da via da dieta (outro)">
                                    </div>
                                    <div id="dieta-aceitacao-container">
                                        <label class="font-medium text-secondary">Aceitação da dieta:</label>
                                        <select id="dieta-aceitacao" class="form-select w-full mt-1">
                                            <option value="">-- Selecione --</option>
                                            <option value="Boa">Boa</option>
                                            <option value="Regular">Regular</option>
                                            <option value="Ruim">Ruim</option>
                                        </select>
                                    </div>
                                     <div>
                                        <label class="font-medium text-secondary">Diurese (Tipo):</label>
                                        <select id="diurese-tipo" class="form-select w-full mt-1">
                                            <option value="">-- Selecione --</option>
                                            <option value="Espontânea">Espontânea</option>
                                            <option value="Sonda Vesical de Demora">Sonda Vesical de Demora</option>
                                            <option value="Anúria/Oligúria">Anúria/Oligúria</option>
                                            <option value="Ausente">Ausente</option>
                                            <option value="outro">Outro</option>
                                        </select>
                                    </div>
                                    <div id="diurese-tipo-outro-container" class="hidden">
                                        <label class="font-medium text-secondary">Detalhes Diurese:</label>
                                        <input type="text" id="diurese-tipo-outro" class="form-input w-full mt-1" placeholder="Detalhe do tipo de diurese (outro)">
                                    </div>
                                    <div>
                                        <label class="font-medium text-secondary">Diurese (Qtde):</label>
                                        <input type="text" id="diurese" placeholder="mL/24h" class="form-input w-full mt-1">
                                    </div>
                                    <div>
                                        <label class="font-medium text-secondary">Evacuações (Tipo):</label>
                                        <select id="evacuacoes-tipo" class="form-select w-full mt-1">
                                            <option value="">-- Selecione --</option>
                                            <option value="Presentes e Fisiológicas">Presentes e Fisiológicas</option>
                                            <option value="Diarreia">Diarréia</option>
                                            <option value="Constipação">Constipação</option>
                                            <option value="Melena">Melena</option>
                                            <option value="Hematoquezia">Hematoquezia</option>
                                            <option value="Ausentes">Ausentes</option>
                                            <option value="outro">Outro</option>
                                        </select>
                                    </div>
                                    <div id="evacuacoes-tipo-outro-container" class="hidden">
                                        <label class="font-medium text-secondary">Detalhes Evacuações:</label>
                                        <input type="text" id="evacuacoes-tipo-outro" class="form-input w-full mt-1" placeholder="Detalhe do tipo de evacuações (outro)">
                                    </div>
                                    <div>
                                        <label class="font-medium text-secondary">Evacuações (Qtde):</label>
                                        <input type="text" id="evacuacoes" placeholder="nº/24h" class="form-input w-full mt-1">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="border-t border-[var(--md-divider)]">
                             <button class="js-accordion-header w-full flex justify-between items-center text-left p-4" aria-expanded="false">
                                <span class="text-lg font-medium text-primary">Picos e Eventos nas 24h</span>
                                <i class="fas fa-chevron-down chevron-icon text-secondary"></i>
                            </button>
                            <div class="accordion-content hidden p-4 border-t border-[var(--md-divider)]">
                                <div class="grid-container">
                                    <div>
                                        <label class="font-medium text-secondary">Pico PA (mmHg):</label>
                                        <input type="text" id="pico-pa" placeholder="Valor" class="form-input w-full mt-1">
                                        <input type="time" id="pico-pa-hora" class="form-input w-full mt-1">
                                    </div>
                                    <div>
                                        <label class="font-medium text-secondary">Queda PA (mmHg):</label>
                                        <input type="text" id="queda-pa" placeholder="Valor" class="form-input w-full mt-1">
                                        <input type="time" id="queda-pa-hora" class="form-input w-full mt-1">
                                    </div>
                                    <div>
                                        <label class="font-medium text-secondary">Pico Temp (°C):</label>
                                        <input type="text" id="pico-temp" placeholder="Valor" class="form-input w-full mt-1">
                                        <input type="time" id="pico-temp-hora" class="form-input w-full mt-1">
                                    </div>
                                    <div>
                                        <label class="font-medium text-secondary">Queda Temp (°C):</label>
                                        <input type="text" id="queda-temp" placeholder="Valor" class="form-input w-full mt-1">
                                        <input type="time" id="queda-temp-hora" class="form-input w-full mt-1">
                                    </div>
                                    <div>
                                        <label class="font-medium text-secondary">Pico Glicêmico (mg/dL):</label>
                                        <input type="text" id="pico-glicemia" placeholder="Valor" class="form-input w-full mt-1">
                                        <input type="time" id="pico-glicemia-hora" class="form-input w-full mt-1">
                                    </div>
                                    <div>
                                        <label class="font-medium text-secondary">Queda Glicêmica (mg/dL):</label>
                                        <input type="text" id="queda-glicemia" placeholder="Valor" class="form-input w-full mt-1">
                                        <input type="time" id="queda-glicemia-hora" class="form-input w-full mt-1">
                                    </div>
                                    <div>
                                        <label class="font-medium text-secondary">Pico SatO₂ (%):</label>
                                        <input type="text" id="pico-sato2" placeholder="Valor" class="form-input w-full mt-1">
                                        <input type="time" id="pico-sato2-hora" class="form-input w-full mt-1">
                                    </div>
                                    <div>
                                        <label class="font-medium text-secondary">Queda SatO₂ (%):</label>
                                        <input type="text" id="queda-sato2" placeholder="Valor" class="form-input w-full mt-1">
                                        <input type="time" id="queda-sato2-hora" class="form-input w-full mt-1">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="md-card">
                        <button class="js-accordion-header accordion-header w-full flex justify-between items-center p-4 md:p-5 text-left bg-md-surface hover:bg-gray-100 dark:hover:bg-opacity-5 rounded-lg" aria-expanded="false">
                            <div class="flex items-center space-x-4">
                                <i class="fas fa-stethoscope text-xl text-blue-500"></i>
                                <h2 class="text-lg md:text-xl font-medium text-primary">3. Exame Físico</h2>
                            </div>
                            <i class="fas fa-chevron-down chevron-icon text-secondary"></i>
                        </button>
                        <div class="accordion-content border-t hidden">
                            <div>
                                <button class="js-accordion-header w-full flex justify-between items-center text-left p-4" aria-expanded="false">
                                    <span class="text-lg font-medium text-primary">Geral</span>
                                    <i class="fas fa-chevron-down chevron-icon text-secondary"></i>
                                </button>
                                <div class="accordion-content hidden p-4 border-t border-[var(--md-divider)]">
                                     <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-4">
                                        <div>
                                            <label class="font-medium text-secondary">Aparência Geral:</label>
                                            <select id="ef-aparencia-geral" class="form-select mt-1 w-full">
                                                <option value="">-- Selecione --</option>
                                                <option value="Boa">Boa</option>
                                                <option value="Regular">Regular</option>
                                                <option value="Ruim">Ruim</option>
                                                <option value="Grave">Grave</option>
                                                <option value="outro">Outro</option>
                                            </select>
                                        </div>
                                        <div id="ef-aparencia-geral-outro-container" class="hidden">
                                            <label class="font-medium text-secondary">Detalhes:</label>
                                            <input type="text" id="ef-aparencia-geral-outro" class="form-input w-full mt-1" placeholder="Ex: Cansado, apático">
                                        </div>
                                        <div>
                                            <label class="font-medium text-secondary">Expressão Facialis / Fácies:</label>
                                            <select id="ef-facies" class="form-select mt-1 w-full">
                                                <option value="">-- Selecione --</option>
                                                <option value="Atípica">Atípica</option>
                                                <option value="Dolorosa">Dolorosa</option>
                                                <option value="Ansiosa">Ansiosa</option>
                                                <option value="Calma">Calma</option>
                                                <option value="outro">Outro</option>
                                            </select>
                                        </div>
                                        <div id="ef-facies-outro-container" class="hidden">
                                            <label class="font-medium text-secondary">Detalhes:</label>
                                            <input type="text" id="ef-facies-outro" class="form-input w-full mt-1" placeholder="Ex: De sofrimento, inexpressiva">
                                        </div>
                                        <div>
                                            <label class="font-medium text-secondary">Sinais de Desconforto/Sofrimento:</label>
                                            <select id="ef-desconforto" class="form-select mt-1 w-full">
                                                <option value="">-- Selecione --</option>
                                                <option value="Ausentes">Ausentes</option>
                                                <option value="Leve">Leve</option>
                                                <option value="Moderado">Moderado</option>
                                                <option value="Intenso">Intenso</option>
                                                <option value="outro">Outro</option>
                                            </select>
                                        </div>
                                        <div id="ef-desconforto-outro-container" class="hidden">
                                            <label class="font-medium text-secondary">Detalhes:</label>
                                            <input type="text" id="ef-desconforto-outro" class="form-input w-full mt-1" placeholder="Ex: Dispneia, dor, agitação">
                                        </div>
                                        <div>
                                            <label class="font-medium text-secondary">Contato / Interação:</label>
                                            <select id="ef-contato" class="form-select mt-1 w-full">
                                                <option value="">-- Selecione --</option>
                                                <option value="Ativo e Cooperativo">Ativo e Cooperativo</option>
                                                <option value="Retraído">Retraído</option>
                                                <option value="Irritável">Irritável</option>
                                                <option value="Apático">Apático</option>
                                                <option value="Ausente">Ausente</option>
                                                <option value="outro">Outro</option>
                                            </select>
                                        </div>
                                        <div id="ef-contato-outro-container" class="hidden">
                                            <label class="font-medium text-secondary">Detalhes:</label>
                                            <input type="text" id="ef-contato-outro" class="form-input w-full mt-1" placeholder="Ex: Responde a estímulos dolorosos">
                                        </div>
                                        <div>
                                            <label class="font-medium text-secondary">Estado Nutricional:</label>
                                            <select id="ef-estado-nutricional" class="form-select mt-1 w-full">
                                                <option value="">-- Selecione --</option>
                                                <option value="Eutrófico">Eutrófico</option>
                                                <option value="Desnutrido">Desnutrido</option>
                                                <option value="Obeso">Obeso</option>
                                                <option value="Caquético">Caquético</option>
                                                <option value="outro">Outro</option>
                                            </select>
                                        </div>
                                        <div id="ef-estado-nutricional-outro-container" class="hidden">
                                            <label class="font-medium text-secondary">Detalhes (Estado Nutricional):</label>
                                            <input type="text" id="ef-estado-nutricional-outro" class="form-input w-full mt-1" placeholder="Detalhe do estado nutricional">
                                        </div>
                                        <div>
                                            <label class="font-medium text-secondary">Decúbito/Mobilidade:</label>
                                            <select id="ef-decubito" class="form-select mt-1 w-full">
                                                <option value="">-- Selecione --</option>
                                                <option value="Ativo no leito">Ativo no leito</option>
                                                <option value="Restrito ao leito">Restrito ao leito</option>
                                                <option value="Decúbito Dorsal">Decúbito Dorsal</option>
                                                <option value="Decúbito Lateral Direito">Decúbito Lateral Direito</option>
                                                <option value="Decúbito Lateral Esquerdo">Decúbito Lateral Esquerdo</option>
                                                <option value="Deambula com auxílio">Deambula com auxílio</option>
                                                <option value="Deambula sem auxílio">Deambula sem auxílio</option>
                                                <option value="outro">Outro</option>
                                            </select>
                                        </div>
                                        <div id="ef-decubito-outro-container" class="hidden">
                                            <label class="font-medium text-secondary">Detalhes (Decúbito/Mobilidade):</label>
                                            <input type="text" id="ef-decubito-outro" class="form-input w-full mt-1" placeholder="Detalhe do decúbito/mobilidade">
                                        </div>
                                        <div class="col-span-full">
                                            <label class="font-medium text-secondary">Dispositivos, Sondas, Cateteres ou Drenos:</label>
                                            <textarea id="ef-dispositivos" rows="2" class="form-textarea w-full mt-1" placeholder="Ex: Sonda vesical de demora, CVC em subclávia direita, dreno de tórax, acesso venoso periférico em MSE sem sinais flogísticos."></textarea>
                                        </div>
                                    </div>
                                    <div class="flex flex-wrap gap-x-6 gap-y-2 mb-4">
                                        <label class="flex items-center text-secondary"><input type="checkbox" id="ef-corado" class="form-checkbox"><span class="ml-1">Corado</span></label>
                                        <label class="flex items-center text-secondary"><input type="checkbox" id="ef-hidratado" class="form-checkbox"><span class="ml-1">Hidratado</span></label>
                                        <label class="flex items-center text-secondary"><input type="checkbox" id="ef-anictérico" class="form-checkbox"><span class="ml-1">Anictérico</span></label>
                                        <label class="flex items-center text-secondary"><input type="checkbox" id="ef-acianotico" class="form-checkbox"><span class="ml-1">Acianótico</span></label>
                                        <label class="flex items-center text-secondary"><input type="checkbox" id="ef-afebril" class="form-checkbox"><span class="ml-1">Afebril</span></label>
                                        <label class="flex items-center text-secondary"><input type="checkbox" id="ef-eupneico" class="form-checkbox"><span class="ml-1">Eupneico</span></label>
                                    </div>
                                    <textarea id="ef-geral-obs" rows="1" class="form-textarea w-full" placeholder="Outras observações gerais"></textarea>
                                </div>
                            </div>

                            <div class="border-t border-[var(--md-divider)]">
                                <button class="js-accordion-header w-full flex justify-between items-center text-left p-4" aria-expanded="false">
                                    <span class="text-lg font-medium text-primary">Neurológico</span>
                                    <i class="fas fa-chevron-down chevron-icon text-secondary"></i>
                                </button>
                                <div class="accordion-content hidden p-4 border-t border-[var(--md-divider)]">
                                    <div class="grid-container">
                                        <div>
                                            <label class="font-medium text-secondary">Nível de Consciência:</label>
                                            <select id="neuro-consciencia-ef" class="form-select mt-1 w-full">
                                                <option value="">-- Selecione --</option>
                                                <option value="Lúcido e Orientado (T/E)">Lúcido e Orientado (T/E)</option>
                                                <option value="Confuso">Confuso</option>
                                                <option value="Agitado">Agitado</option>
                                                <option value="Desorientado">Desorientado</option>
                                                <option value="Sonolento">Sonolento</option>
                                                <option value="Obnubilado">Obnubilado</option>
                                                <option value="Estuporoso">Estuporoso</option>
                                                <option value="Em Coma">Em Coma</option>
                                                <option value="outro">Outro</option>
                                            </select>
                                        </div>
                                        <div id="neuro-consciencia-ef-outro-container" class="hidden">
                                            <label class="font-medium text-secondary">Detalhes:</label>
                                            <input type="text" id="neuro-consciencia-ef-outro" class="form-input w-full mt-1" placeholder="Detalhe do nível de consciência">
                                        </div>
                                        <div>
                                            <label class="font-medium text-secondary">Pupilas:</label>
                                            <select id="neuro-pupilas" class="form-select mt-1 w-full">
                                                <option value="">-- Selecione --</option>
                                                <option value="Isocóricas e Fotorreagentes">Isocóricas e Fotorreagentes</option>
                                                <option value="Lentamente Fotorreagentes">Lentamente Fotorreagentes</option>
                                                <option value="Mióticas">Mióticas</option>
                                                <option value="Midriáticas">Midriáticas</option>
                                                <option value="Anisocóricas">Anisocóricas</option>
                                                <option value="outro">Outro</option>
                                            </select>
                                        </div>
                                        <div id="neuro-pupilas-outro-container" class="hidden">
                                            <label class="font-medium text-secondary">Detalhes:</label>
                                            <input type="text" id="neuro-pupilas-outro" class="form-input w-full mt-1" placeholder="Detalhe das pupilas">
                                        </div>
                                        <div>
                                            <label class="font-medium text-secondary">Pares Cranianos:</label>
                                            <select id="neuro-pares" class="form-select mt-1 w-full">
                                                <option value="">-- Selecione --</option>
                                                <option value="Preservados">Preservados</option>
                                                <option value="Alterados">Alterados</option>
                                                <option value="outro">Outro</option>
                                            </select>
                                        </div>
                                        <div id="neuro-pares-detalhes-container" class="hidden">
                                            <label class="font-medium text-secondary">Detalhes (Pares):</label>
                                            <input type="text" id="neuro-pares-detalhes" class="form-input w-full mt-1" placeholder="Descreva a alteração">
                                        </div>
                                        <div id="neuro-pares-outro-container" class="hidden">
                                            <label class="font-medium text-secondary">Detalhes:</label>
                                            <input type="text" id="neuro-pares-outro" class="form-input w-full mt-1" placeholder="Detalhe dos pares cranianos">
                                        </div>
                                        <div>
                                            <label class="font-medium text-secondary">Força Motora:</label>
                                            <select id="neuro-forca-motora" class="form-select mt-1 w-full">
                                                <option value="">-- Selecione --</option>
                                                <option value="Preservada nos 4 Membros">Preservada nos 4 Membros</option>
                                                <option value="Diminuída">Diminuída</option>
                                                <option value="Paresia (localizar)">Paresia (localizar)</option>
                                                <option value="Plegia (localizar)">Plegia (localizar)</option>
                                                <option value="Hemiplegia">Hemiplegia</option>
                                                <option value="Tetraplegia">Tetraplegia</option>
                                                <option value="outro">Outro</option>
                                            </select>
                                        </div>
                                        <div id="neuro-forca-motora-detalhes-container" class="hidden">
                                            <label class="font-medium text-secondary">Detalhes (Força):</label>
                                            <input type="text" id="neuro-forca-motora-detalhes" class="form-input w-full mt-1" placeholder="Localização e grau">
                                        </div>
                                        <div id="neuro-forca-motora-outro-container" class="hidden">
                                            <label class="font-medium text-secondary">Detalhes:</label>
                                            <input type="text" id="neuro-forca-motora-outro" class="form-input w-full mt-1" placeholder="Detalhe da força motora">
                                        </div>
                                        <div>
                                            <label class="font-medium text-secondary">Sensibilidade:</label>
                                            <select id="neuro-sensibilidade" class="form-select mt-1 w-full">
                                                <option value="">-- Selecione --</option>
                                                <option value="Preservada">Preservada</option>
                                                <option value="Diminuída">Diminuída</option>
                                                <option value="Alterada">Alterada</option>
                                                <option value="outro">Outro</option>
                                            </select>
                                        </div>
                                        <div id="neuro-sensibilidade-outro-container" class="hidden">
                                            <label class="font-medium text-secondary">Detalhes:</label>
                                            <input type="text" id="neuro-sensibilidade-outro" class="form-input w-full mt-1" placeholder="Detalhe da sensibilidade">
                                        </div>
                                        <div>
                                            <label class="font-medium text-secondary">Reflexos:</label>
                                            <select id="neuro-reflexos" class="form-select mt-1 w-full">
                                                <option value="">-- Selecione --</option>
                                                <option value="Preservados">Preservados</option>
                                                <option value="Hiporreflexia">Hiporreflexia</option>
                                                <option value="Arreflexia">Arreflexia</option>
                                                <option value="Hiperreflexia">Hiperreflexia</option>
                                                <option value="outro">Outro</option>
                                            </select>
                                        </div>
                                        <div id="neuro-reflexos-outro-container" class="hidden">
                                            <label class="font-medium text-secondary">Detalhes:</label>
                                            <input type="text" id="neuro-reflexos-outro" class="form-input w-full mt-1" placeholder="Detalhe dos reflexos">
                                        </div>
                                        <div>
                                            <label class="font-medium text-secondary">Sinais Meníngeos:</label>
                                            <select id="neuro-meningeos" class="form-select mt-1 w-full">
                                                <option value="">-- Selecione --</option>
                                                <option value="Ausentes">Ausentes</option>
                                                <option value="Presentes">Presentes</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="font-medium text-secondary">Escore de Glasgow:</label>
                                            <input type="text" id="glasgow" placeholder="E, V, M" class="form-input w-full mt-1">
                                        </div>
                                        <div>
                                            <label class="font-medium text-secondary">Escala de RASS:</label>
                                            <select id="neuro-rass" class="form-select mt-1 w-full">
                                                <option value="">-- Selecione --</option>
                                                <option value="+4 Agitado Combativo">+4 Agitado Combativo</option>
                                                <option value="+3 Muito Agitado">+3 Muito Agitado</option>
                                                <option value="+2 Agitado">+2 Agitado</option>
                                                <option value="+1 Inquieto">+1 Inquieto</option>
                                                <option value="0 Alerta e Calmo">0 Alerta e Calmo</option>
                                                <option value="-1 Sonolento">-1 Sonolento</option>
                                                <option value="-2 Sedação Leve">-2 Sedação Leve</option>
                                                <option value="-3 Sedação Moderada">-3 Sedação Moderada</option>
                                                <option value="-4 Sedação Profunda">-4 Sedação Profunda</option>
                                                <option value="-5 Não Despertável">-5 Não Despertável</option>
                                            </select>
                                        </div>
                                    </div>
                                    <textarea id="neuro-obs" rows="2" class="form-textarea w-full mt-4" placeholder="Outras observações neurológicas"></textarea>
                                </div>
                            </div>

                            <div class="border-t border-[var(--md-divider)]">
                                <button class="js-accordion-header w-full flex justify-between items-center text-left p-4" aria-expanded="false">
                                    <span class="text-lg font-medium text-primary">Cardiovascular</span>
                                    <i class="fas fa-chevron-down chevron-icon text-secondary"></i>
                                </button>
                                <div class="accordion-content hidden p-4 border-t border-[var(--md-divider)]">
                                    <div class="grid-container">
                                        <div>
                                            <label class="font-medium text-secondary">Ritmo:</label>
                                            <select id="cardio-ritmo" class="form-select mt-1 w-full">
                                                <option value="">-- Selecione --</option>
                                                <option value="Regular">Regular</option>
                                                <option value="Irregular">Irregular</option>
                                                <option value="outro">Outro</option>
                                            </select>
                                        </div>
                                        <div id="cardio-ritmo-outro-container" class="hidden">
                                            <label class="font-medium text-secondary">Detalhes:</label>
                                            <input type="text" id="cardio-ritmo-outro" class="form-input w-full mt-1" placeholder="Detalhe do ritmo">
                                        </div>
                                        <div>
                                            <label class="font-medium text-secondary">Bulhas:</label>
                                            <select id="cardio-bulhas" class="form-select mt-1 w-full">
                                                <option value="">-- Selecione --</option>
                                                <option value="Normofonéticas">Normofonéticas</option>
                                                <option value="Hipofonéticas">Hipofonéticas</option>
                                                <option value="Hiperfonéticas">Hiperfonéticas</option>
                                                <option value="Desdobradas">Desdobradas</option>
                                                <option value="outro">Outro</option>
                                            </select>
                                        </div>
                                        <div id="cardio-bulhas-outro-container" class="hidden">
                                            <label class="font-medium text-secondary">Detalhes (Bulhas):</label>
                                            <input type="text" id="cardio-bulhas-outro" class="form-input w-full mt-1" placeholder="Detalhe das bulhas">
                                        </div>
                                        <div>
                                            <label class="font-medium text-secondary">Tempos:</label>
                                            <select id="cardio-bulhas-tempos" class="form-select mt-1 w-full">
                                                <option value="">-- Selecione --</option>
                                                <option value="em 2 Tempos">em 2 Tempos</option>
                                                <option value="em 3 Tempos">em 3 Tempos</option>
                                                <option value="outro">Outro</option>
                                            </select>
                                        </div>
                                        <div id="cardio-bulhas-tempos-outro-container" class="hidden">
                                            <label class="font-medium text-secondary">Detalhes (Tempos):</label>
                                            <input type="text" id="cardio-bulhas-tempos-outro" class="form-input w-full mt-1" placeholder="Detalhe dos tempos">
                                        </div>
                                        <div>
                                            <label class="font-medium text-secondary">Sopros:</label>
                                            <select id="cardio-sopros" class="form-select mt-1 w-full">
                                                <option value="">-- Selecione --</option>
                                                <option value="Ausentes">Ausentes</option>
                                                <option value="Sopro Sistólico Ejetivo">Sopro Sistólico Ejetivo</option>
                                                <option value="Sopro Sistólico Regurgitativo">Sopro Sistólico Regurgitativo</option>
                                                <option value="Sopro Diastólico">Sopro Diastólico</option>
                                                <option value="outro">Outro</option>
                                            </select>
                                        </div>
                                        <div id="cardio-sopros-detalhes-container" class="hidden">
                                            <label class="font-medium text-secondary">Detalhes (Sopros):</label>
                                            <input type="text" id="cardio-sopros-detalhes" class="form-input w-full mt-1" placeholder="Foco, irradiação, intensidade">
                                        </div>
                                        <div id="cardio-sopros-outro-container" class="hidden">
                                            <label class="font-medium text-secondary">Detalhes:</label>
                                            <input type="text" id="cardio-sopros-outro" class="form-input w-full mt-1" placeholder="Detalhe dos sopros">
                                        </div>
                                        <div>
                                            <label class="font-medium text-secondary">Turgência Jugular:</label>
                                            <select id="cardio-tj" class="form-select mt-1 w-full">
                                                <option value="">-- Selecione --</option>
                                                <option value="Ausente">Ausente</option>
                                                <option value="Presente">Presente</option>
                                                <option value="outro">Outro</option>
                                            </select>
                                        </div>
                                        <div id="cardio-tj-outro-container" class="hidden">
                                            <label class="font-medium text-secondary">Detalhes:</label>
                                            <input type="text" id="cardio-tj-outro" class="form-input w-full mt-1" placeholder="Detalhe da turgência jugular">
                                        </div>
                                        <div>
                                            <label class="font-medium text-secondary">Ictus:</label>
                                            <select id="cardio-ictus" class="form-select mt-1 w-full">
                                                <option value="">-- Selecione --</option>
                                                <option value="Não Palpável">Não Palpável</option>
                                                <option value="Palpável">Palpável</option>
                                                <option value="Desviado">Desviado</option>
                                                <option value="outro">Outro</option>
                                            </select>
                                        </div>
                                        <div id="cardio-ictus-outro-container" class="hidden">
                                            <label class="font-medium text-secondary">Detalhes:</label>
                                            <input type="text" id="cardio-ictus-outro" class="form-input w-full mt-1" placeholder="Detalhe do ictus">
                                        </div>
                                    </div>
                                    <textarea id="ef-cardio-obs" rows="2" class="form-textarea w-full mt-4" placeholder="Outras observações cardiovasculares"></textarea>
                                </div>
                            </div>

                            <div class="border-t border-[var(--md-divider)]">
                                <button class="js-accordion-header w-full flex justify-between items-center text-left p-4" aria-expanded="false">
                                    <span class="text-lg font-medium text-primary">Respiratório</span>
                                    <i class="fas fa-chevron-down chevron-icon text-secondary"></i>
                                </button>
                                <div class="accordion-content hidden p-4 border-t border-[var(--md-divider)]">
                                    <div class="grid-container">
                                        <div>
                                            <label class="font-medium text-secondary">Padrão Respiratório:</label>
                                            <select id="resp-padrao" class="form-select mt-1 w-full">
                                                <option value="">-- Selecione --</option>
                                                <option value="Eupnéico">Eupnéico</option>
                                                <option value="Taquipneico">Taquipneico</option>
                                                <option value="Bradipneico">Bradipneico</option>
                                                <option value="Hiperpneico">Hiperpneico</option>
                                                <option value="Kussmaul">Kussmaul</option>
                                                <option value="Cheyne-Stokes">Cheyne-Stokes</option>
                                                <option value="outro">Outro</option>
                                            </select>
                                        </div>
                                        <div id="resp-padrao-outro-container" class="hidden">
                                            <label class="font-medium text-secondary">Detalhes:</label>
                                            <input type="text" id="resp-padrao-outro" class="form-input w-full mt-1" placeholder="Detalhe do padrão">
                                        </div>
                                        <div>
                                            <label class="font-medium text-secondary">Ausculta Pulmonar:</label>
                                            <select id="ausculta-resp" class="form-select mt-1 w-full">
                                                <option value="">-- Selecione --</option>
                                                <option value="Murmúrio Vesicular Presente">Murmúrio Vesicular Presente</option>
                                                <option value="Murmúrio Vesicular Diminuído">Murmúrio Vesicular Diminuído</option>
                                                <option value="Murmúrio Vesicular Abolido">Murmúrio Vesicular Abolido</option>
                                                <option value="outro">Outro</option>
                                            </select>
                                        </div>
                                        <div id="ausculta-resp-outro-container" class="hidden">
                                            <label class="font-medium text-secondary">Detalhes:</label>
                                            <input type="text" id="ausculta-resp-outro" class="form-input w-full mt-1" placeholder="Detalhe da ausculta pulmonar">
                                        </div>
                                        <div>
                                            <label class="font-medium text-secondary">Ruídos Adventícios:</label>
                                            <select id="ra-resp" class="form-select mt-1 w-full">
                                                <option value="">-- Selecione --</option>
                                                <option value="Ausentes">Ausentes</option>
                                                <option value="Crepitações">Crepitações</option>
                                                <option value="Estertores Bolhosos">Estertores Bolhosos</option>
                                                <option value="Sibilos">Sibilos</option>
                                                <option value="Roncos">Roncos</option>
                                                <option value="Atrito Pleural">Atrito Pleural</option>
                                                <option value="outro">Outro</option>
                                            </select>
                                        </div>
                                        <div id="ra-resp-detalhes-container" class="hidden">
                                            <label class="font-medium text-secondary">Detalhes (Ruídos):</label>
                                            <input type="text" id="ra-resp-detalhes" class="form-input w-full mt-1" placeholder="Localização do ruído">
                                        </div>
                                        <div id="ra-resp-outro-container" class="hidden">
                                            <label class="font-medium text-secondary">Detalhes:</label>
                                            <input type="text" id="ra-resp-outro" class="form-input w-full mt-1" placeholder="Detalhe dos ruídos adventícios">
                                        </div>
                                        <div>
                                            <label class="font-medium text-secondary">Dispneia:</label>
                                            <select id="ef-resp-dispneia" class="form-select mt-1 w-full">
                                                <option value="">-- Selecione --</option>
                                                <option value="Ausente">Ausente</option>
                                                <option value="Aos Grandes Esforços">Aos Grandes Esforços</option>
                                                <option value="Aos Médios Esforços">Aos Médios Esforços</option>
                                                <option value="Aos Pequenos Esforços">Aos Pequenos Esforços</option>
                                                <option value="Em Reposo">Em Repouso</option>
                                                <option value="outro">Outro</option>
                                            </select>
                                        </div>
                                        <div id="ef-resp-dispneia-outro-container" class="hidden">
                                            <label class="font-medium text-secondary">Detalhes:</label>
                                            <input type="text" id="ef-resp-dispneia-outro" class="form-input w-full mt-1" placeholder="Detalhe da dispneia">
                                        </div>
                                        <div>
                                            <label class="font-medium text-secondary">Tosse:</label>
                                            <select id="ef-resp-tosse-geral" class="form-select mt-1 w-full">
                                                <option value="">-- Selecione --</option>
                                                <option value="Sim">Sim</option>
                                                <option value="Não">Não</option>
                                            </select>
                                        </div>
                                        <div id="ef-resp-tosse-detalhes-container" class="hidden">
                                            <label class="font-medium text-secondary">Tipo de Tosse:</label>
                                            <select id="ef-resp-tosse" class="form-select mt-1 w-full">
                                                <option value="">-- Selecione --</option>
                                                <option value="Tosse Seca">Tosse Seca</option>
                                                <option value="Tosse Produtiva">Tosse Produtiva</option>
                                                <option value="outro">Outro</option>
                                            </select>
                                        </div>
                                        <div id="ef-resp-tosse-outro-container" class="hidden">
                                            <label class="font-medium text-secondary">Detalhes:</label>
                                            <input type="text" id="ef-resp-tosse-outro" class="form-input w-full mt-1" placeholder="Ex: Expectoração hialina, etc.">
                                        </div>
                                    </div>
                                    <textarea id="ef-resp-obs" rows="2" class="form-textarea w-full mt-4" placeholder="Outras observações respiratórias"></textarea>
                                </div>
                            </div>

                            <div class="border-t border-[var(--md-divider)]">
                                <button class="js-accordion-header w-full flex justify-between items-center text-left p-4" aria-expanded="false">
                                    <span class="text-lg font-medium text-primary">Abdominal</span>
                                    <i class="fas fa-chevron-down chevron-icon text-secondary"></i>
                                </button>
                                <div class="accordion-content hidden p-4 border-t border-[var(--md-divider)]">
                                    <div class="grid-container">
                                        <div>
                                            <label class="font-medium text-secondary">Forma:</label>
                                            <select id="ef-abd-forma" class="form-select mt-1 w-full">
                                                <option value="">-- Selecione --</option>
                                                <option value="Plano">Plano</option>
                                                <option value="Globoso">Globoso</option>
                                                <option value="Semigloboso">Semigloboso</option>
                                                <option value="Escavado">Escavado</option>
                                                <option value="outro">Outro</option>
                                            </select>
                                        </div>
                                        <div id="ef-abd-forma-outro-container" class="hidden">
                                            <label class="font-medium text-secondary">Detalhes:</label>
                                            <input type="text" id="ef-abd-forma-outro" class="form-input w-full mt-1" placeholder="Detalhe da forma abdominal">
                                        </div>
                                        <div>
                                            <label class="font-medium text-secondary">Consistência:</label>
                                            <select id="ef-abd-consistencia" class="form-select mt-1 w-full">
                                                <option value="">-- Selecione --</option>
                                                <option value="Flácido">Flácido</option>
                                                <option value="Depressível">Depressível</option>
                                                <option value="Tenso">Tenso</option>
                                                <option value="outro">Outro</option>
                                            </select>
                                        </div>
                                        <div id="ef-abd-consistencia-outro-container" class="hidden">
                                            <label class="font-medium text-secondary">Detalhes:</label>
                                            <input type="text" id="ef-abd-consistencia-outro" class="form-input w-full mt-1" placeholder="Detalhe da consistência">
                                        </div>
                                        <div>
                                            <label class="font-medium text-secondary">Dor à Palpação:</label>
                                            <select id="ef-abd-dor" class="form-select mt-1 w-full">
                                                <option value="">-- Selecione --</option>
                                                <option value="Indolor">Indolor</option>
                                                <option value="Doloroso">Doloroso</option>
                                                <option value="Dor à Descompressão Brusca">Dor à Descompressão Brusca</option>
                                                <option value="outro">Outro</option>
                                            </select>
                                        </div>
                                        <div id="ef-abd-dor-outro-container" class="hidden">
                                            <label class="font-medium text-secondary">Detalhes:</label>
                                            <input type="text" id="ef-abd-dor-outro" class="form-input w-full mt-1" placeholder="Detalhe da dor à palpação">
                                        </div>
                                        <div>
                                            <label class="font-medium text-secondary">Visceromegalias:</label>
                                            <select id="ef-abd-viscero" class="form-select mt-1 w-full">
                                                <option value="">-- Selecione --</option>
                                                <option value="Ausentes">Ausentes</option>
                                                <option value="Hepatomegalia">Hepatomegalia</option>
                                                <option value="Esplenomegalia">Esplenomegalia</option>
                                                <option value="Massa Palpável">Massa Palpável</option>
                                                <option value="outro">Outro</option>
                                            </select>
                                        </div>
                                        <div id="ef-abd-viscero-outro-container" class="hidden">
                                            <label class="font-medium text-secondary">Detalhes:</label>
                                            <input type="text" id="ef-abd-viscero-outro" class="form-input w-full mt-1" placeholder="Detalhe de visceromegalias">
                                        </div>
                                        <div>
                                            <label class="font-medium text-secondary">Ruídos Hidroaéreos:</label>
                                            <select id="ef-abd-sons" class="form-select mt-1 w-full">
                                                <option value="">-- Selecione --</option>
                                                <option value="Presentes">Presentes</option>
                                                <option value="Aumentados">Aumentados</option>
                                                <option value="Diminuídos">Diminuídos</option>
                                                <option value="Ausentes">Ausentes</option>
                                                <option value="outro">Outro</option>
                                            </select>
                                        </div>
                                        <div id="ef-abd-sons-outro-container" class="hidden">
                                            <label class="font-medium text-secondary">Detalhes:</label>
                                            <input type="text" id="ef-abd-sons-outro" class="form-input w-full mt-1" placeholder="Detalhe dos sons abdominais">
                                        </div>
                                    </div>
                                    <textarea id="ef-abd-obs" rows="2" class="form-textarea w-full mt-4" placeholder="Outras observações abdominais"></textarea>
                                </div>
                            </div>

                            <div class="border-t border-[var(--md-divider)]">
                                <button class="js-accordion-header w-full flex justify-between items-center text-left p-4" aria-expanded="false">
                                    <span class="text-lg font-medium text-primary">Pele e Periférico</span>
                                    <i class="fas fa-chevron-down chevron-icon text-secondary"></i>
                                </button>
                                <div class="accordion-content hidden p-4 border-t border-[var(--md-divider)]">
                                    <div class="grid-container">
                                        <div>
                                            <label class="font-medium text-secondary">Temperatura:</label>
                                            <select id="pele-temp" class="form-select mt-1 w-full">
                                                <option value="">-- Selecione --</option>
                                                <option value="Aquecidas">Aquecidas</option>
                                                <option value="Frias">Frias</option>
                                                <option value="outro">Outro</option>
                                            </select>
                                        </div>
                                        <div id="pele-temp-outro-container" class="hidden">
                                            <label class="font-medium text-secondary">Detalhes:</label>
                                            <input type="text" id="pele-temp-outro" class="form-input w-full mt-1" placeholder="Detalhe da temperatura">
                                        </div>
                                        <div>
                                            <label class="font-medium text-secondary">Turgor:</label>
                                            <select id="pele-turgor" class="form-select mt-1 w-full">
                                                <option value="">-- Selecione --</option>
                                                <option value="Preservado">Preservado</option>
                                                <option value="Diminuído">Diminuído</option>
                                                <option value="outro">Outro</option>
                                            </select>
                                        </div>
                                        <div id="pele-turgor-outro-container" class="hidden">
                                            <label class="font-medium text-secondary">Detalhes:</label>
                                            <input type="text" id="pele-turgor-outro" class="form-input w-full mt-1" placeholder="Detalhe do turgor">
                                        </div>
                                        <div>
                                            <label class="font-medium text-secondary">Edema:</label>
                                            <select id="pele-edema" class="form-select mt-1 w-full">
                                                <option value="">-- Selecione --</option>
                                                <option value="Presente">Presente</option>
                                                <option value="Ausente">Ausente</option>
                                            </select>
                                        </div>
                                        <div id="pele-edema-detalhes-container" class="hidden">
                                            <label class="font-medium text-secondary">Detalhes (Edema):</label>
                                            <input type="text" id="pele-edema-detalhes" class="form-input w-full mt-1" placeholder="Ex: +2/4 em MMII">
                                        </div>
                                        <div>
                                            <label class="font-medium text-secondary">Perf. Capilar:</label>
                                            <select id="pele-tec" class="form-select mt-1 w-full">
                                                <option value="">-- Selecione --</option>
                                                <option value="< 3s">< 3s</option>
                                                <option value="> 3s">> 3s</option>
                                                <option value="outro">Outro</option>
                                            </select>
                                        </div>
                                        <div id="pele-tec-outro-container" class="hidden">
                                            <label class="font-medium text-secondary">Detalhes:</label>
                                            <input type="text" id="pele-tec-outro" class="form-input w-full mt-1" placeholder="Detalhe da perfusão capilar">
                                        </div>
                                        <div>
                                            <label class="font-medium text-secondary">Pulsos:</label>
                                            <select id="pele-pulsos" class="form-select mt-1 w-full">
                                                <option value="">-- Selecione --</option>
                                                <option value="Simétricos e Cheios">Simétricos e Cheios</option>
                                                <option value="Diminuídos">Diminuídos</option>
                                                <option value="Filiformes">Filiformes</option>
                                                <option value="outro">Outro</option>
                                            </select>
                                        </div>
                                        <div id="pele-pulsos-outro-container" class="hidden">
                                            <label class="font-medium text-secondary">Detalhes:</label>
                                            <input type="text" id="pele-pulsos-outro" class="form-input w-full mt-1" placeholder="Detalhe dos pulsos">
                                        </div>
                                        <div>
                                            <label class="font-medium text-secondary">Integridade da pele:</label>
                                            <select id="pele-integridade" class="form-select mt-1 w-full">
                                                <option value="">-- Selecione --</option>
                                                <option value="Íntegra">Íntegra</option>
                                                <option value="Icterícia">Icterícia</option>
                                                <option value="Cianose">Cianose</option>
                                                <option value="Úlcera de Pressão">Úlcera de Pressão</option>
                                                <option value="Com Lesões">Com Lesões</option>
                                                <option value="outro">Outro</option>
                                            </select>
                                        </div>
                                        <div id="pele-integridade-detalhes-container" class="hidden">
                                            <label class="font-medium text-secondary">Detalhes (Pele):</label>
                                            <input type="text" id="pele-integridade-detalhes" class="form-input w-full mt-1" placeholder="Descreva as lesões/achados">
                                        </div>
                                        <div id="pele-integridade-outro-container" class="hidden">
                                            <label class="font-medium text-secondary">Detalhes:</label>
                                            <input type="text" id="pele-integridade-outro" class="form-input w-full mt-1" placeholder="Detalhe da integridade da pele">
                                        </div>
                                    </div>
                                    <textarea id="pele-obs" rows="2" class="form-textarea w-full mt-4" placeholder="Outras observações de pele e extremidades"></textarea>
                                </div>
                            </div>

                            <div class="border-t border-[var(--md-divider)]">
                                <button class="js-accordion-header w-full flex justify-between items-center text-left p-4" aria-expanded="false">
                                    <span class="text-lg font-medium text-primary">Outro Sistema</span>
                                    <i class="fas fa-chevron-down chevron-icon text-secondary"></i>
                                </button>
                                <div class="accordion-content hidden p-4 border-t border-[var(--md-divider)]">
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                        <div>
                                            <label for="ef-outro-sistema-nome" class="font-medium text-secondary">Sistema:</label>
                                            <input type="text" id="ef-outro-sistema-nome" placeholder="Ex: Osteomuscular" class="form-input w-full mt-1">
                                        </div>
                                        <div class="col-span-full">
                                            <label for="ef-outro-sistema-descricao" class="font-medium text-secondary">Descrição do exame físico:</label>
                                            <textarea id="ef-outro-sistema-descricao" rows="2" class="form-textarea w-full mt-1" placeholder="Descreva os achados do exame físico para o sistema informado."></textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                 <div class="md-card">
                        <button class="js-accordion-header accordion-header w-full flex justify-between items-center p-4 md:p-5 text-left bg-md-surface hover:bg-gray-100 dark:hover:bg-opacity-5 rounded-lg" aria-expanded="false">
                            <div class="flex items-center space-x-4">
                                <i class="fas fa-file-medical-alt text-xl text-blue-500"></i>
                                <h2 class="text-lg md:text-xl font-medium text-primary">4. Intercorrências e Condutas</h2>
                            </div>
                            <i class="fas fa-chevron-down chevron-icon text-secondary"></i>
                        </button>
                        <div class="accordion-content p-4 md:p-6 border-t hidden space-y-4">
                           <div>
                                <label class="font-medium text-secondary">Intercorrências clínicas:</label>
                                <textarea id="intercorrencias" rows="2" class="form-textarea w-full mt-1" placeholder="Ex: Intercorrência de pico hipertensivo"></textarea>
                            </div>
                            <div>
                                <label class="font-medium text-secondary">Ajustes terapêuticos / prescrições:</label>
                                <textarea id="ajustes" rows="2" class="form-textarea w-full mt-1" placeholder="Ex: Ajustado analgésico, iniciado antibiótico"></textarea>
                            </div>
                        </div>
                    </div>

                 <div class="md-card">
                        <button class="js-accordion-header accordion-header w-full flex justify-between items-center p-4 md:p-5 text-left bg-md-surface hover:bg-gray-100 dark:hover:bg-opacity-5 rounded-lg" aria-expanded="false">
                            <div class="flex items-center space-x-4">
                                <i class="fas fa-vial text-xl text-blue-500"></i>
                                <h2 class="text-lg md:text-xl font-medium text-primary">5. Exames e Resultados</h2>
                            </div>
                            <i class="fas fa-chevron-down chevron-icon text-secondary"></i>
                        </button>
                        <div class="accordion-content p-4 md:p-6 border-t hidden space-y-4">
                           <div>
                                <label class="font-medium text-secondary">Exames Laboratoriais:</label>
                                <textarea id="exames-lab" rows="2" class="form-textarea w-full mt-1" placeholder="Ex: Hemograma, função renal, eletrólitos, etc."></textarea>
                            </div>
                            <div>
                                <label class="font-medium text-secondary">Exames de Imagem:</label>
                                <textarea id="exames-imagem" rows="2" class="form-textarea w-full mt-1" placeholder="Ex: Raio-X de tórax, TC de abdome, etc."></textarea>
                            </div>
                            <div>
                                <label class="font-medium text-secondary">Outros Exames:</label>
                                <textarea id="exames-outros" rows="2" class="form-textarea w-full mt-1" placeholder="Ex: ECG, gasometria, etc."></textarea>
                            </div>
                        </div>
                    </div>

                 <div class="md-card">
                        <button class="js-accordion-header accordion-header w-full flex justify-between items-center p-4 md:p-5 text-left bg-md-surface hover:bg-gray-100 dark:hover:bg-opacity-5 rounded-lg" aria-expanded="false">
                            <div class="flex items-center space-x-4">
                                <i class="fas fa-clipboard-list text-xl text-blue-500"></i>
                                <h2 class="text-lg md:text-xl font-medium text-primary">6. Conduta e Planejamento</h2>
                            </div>
                            <i class="fas fa-chevron-down chevron-icon text-secondary"></i>
                        </button>
                        <div class="accordion-content p-4 md:p-6 border-t hidden space-y-4">
                           <div>
                                <label class="font-medium text-secondary">Conduta para as próximas 24 horas:</label>
                                <textarea id="conduta" rows="2" class="form-textarea w-full mt-1" placeholder="Ex: Manter conduta, reavaliar em 24h."></textarea>
                            </div>
                            <div>
                                <label class="font-medium text-secondary">Outras considerações:</label>
                                <textarea id="planejamento" rows="2" class="form-textarea w-full mt-1" placeholder="Ex: Solicitar avaliação da fonoaudiologia, considerar retirada de acesso venoso central amanhã."></textarea>
                            </div>
                            <div>
                                <label class="font-medium text-secondary">Profilaxias (TVP/TEV, Úlcera de estresse):</label>
                                <textarea id="profilaxias" rows="2" class="form-textarea w-full mt-1" placeholder="Ex: TVP com Enoxaparina 40mg SC 1x/dia, Úlcera de estresse com Pantoprazol 40mg EV 1x/dia."></textarea>
                            </div>
                            </div>
                    </div>
                  </div>
        </main>

        <section class="md-card p-4 md:p-8">
            <div class="flex items-center space-x-4 mb-4">
                <i class="fas fa-magic-sparkles text-xl text-blue-500"></i>
                <h2 class="text-xl md:text-2xl font-semibold text-primary">Resumo Automático</h2>
            </div>
            <div class="generated-summary text-secondary" id="summary-output" style="white-space: pre-wrap;">
                Comece a preencher os campos para gerar o resumo.
            </div>
            <button id="copy-btn" class="mt-6 w-full flex items-center justify-center px-4 py-2 md:px-6 md:py-3 md-button font-medium focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-transform transform active:scale-[0.98]">
                <i class="fas fa-copy mr-2"></i>
                Copiar Resumo
            </button>
        </section>
    </div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const form = document.getElementById('evolution-form');

        // Funções auxiliares de DOM
        const getInputValue = id => document.getElementById(id)?.value.trim() || '';
        const getSelectValue = id => document.getElementById(id)?.value || '';
        const getCheckboxStatus = id => document.getElementById(id)?.checked || false;

        function showHide(elementId, show) {
            const element = document.getElementById(elementId);
            if (!element) return;
            if (show) {
                element.classList.remove('hidden');
            } else {
                element.classList.add('hidden');
                // Clear inputs/selects within hidden container when hiding
                element.querySelectorAll('input, textarea, select').forEach(input => {
                    if (input.type === 'checkbox' || input.type === 'radio') {
                        input.checked = false;
                    } else if (input.tagName === 'SELECT') {
                        input.value = ''; // Reset select to default option
                        // Trigger change event for nested conditional fields
                        const event = new Event('change', { bubbles: true });
                        input.dispatchEvent(event);
                    } else {
                        input.value = '';
                    }
                });
            }
        }

        // Lógica do Tema Escuro
        const themeToggleBtn = document.getElementById('theme-toggle');
        const themeIcon = themeToggleBtn.querySelector('i');
        const userTheme = localStorage.getItem('theme');
        const systemTheme = window.matchMedia('(prefers-color-scheme: dark)').matches;

        const applyTheme = (theme) => {
            if (theme === 'dark') {
                document.documentElement.classList.add('dark');
                themeIcon.classList.replace('fa-moon', 'fa-sun');
                localStorage.setItem('theme', 'dark');
            } else {
                document.documentElement.classList.remove('dark');
                themeIcon.classList.replace('fa-sun', 'fa-moon');
                localStorage.setItem('theme', 'light');
            }
        };

        if (userTheme === 'dark' || (!userTheme && systemTheme)) {
            applyTheme('dark');
        } else {
            applyTheme('light');
        }
        themeToggleBtn.addEventListener('click', () => {
            applyTheme(document.documentElement.classList.contains('dark') ? 'light' : 'dark');
        });

        // Lógica do Accordion com acessibilidade
        document.querySelectorAll('.js-accordion-header').forEach(header => {
            header.addEventListener('click', () => {
                const content = header.nextElementSibling;
                const chevron = header.querySelector('.chevron-icon');
                const isExpanded = header.getAttribute('aria-expanded') === 'true';

                header.setAttribute('aria-expanded', !isExpanded);
                content.classList.toggle('hidden');
                chevron?.classList.toggle('rotate-180');
            });
        });

        // Gerenciador de eventos centralizado para campos condicionais
        form.addEventListener('change', (event) => {
            const { id, value } = event.target;

            // Tratamento genérico para campos 'outro'
            if (document.getElementById(`${id}-outro-container`)) {
                showHide(`${id}-outro-container`, value === 'outro');
            }

            switch (id) {
                case 'queixas':
                    showHide('queixas-obs-container', value === 'Sim');
                    break;
                case 'suporte-vent':
                    showHide('vm-parameters-container', value === 'VM');
                    break;
                case 'dva':
                    showHide('dva-obs-container', value === 'Sim');
                    break;
                case 'dieta-tipo':
                    showHide('dieta-aceitacao-container', value !== 'Jejum' && value !== '');
                    break;
                case 'ef-resp-tosse-geral':
                    showHide('ef-resp-tosse-detalhes-container', value === 'Sim');
                    if (value !== 'Sim') showHide('ef-resp-tosse-outro-container', false); // Ensure nested 'outro' is hidden too
                    break;
                case 'pele-edema':
                    showHide('pele-edema-detalhes-container', value === 'Presente');
                    break;
                case 'neuro-pares':
                    showHide('neuro-pares-detalhes-container', value === 'Alterados');
                    break;
                case 'neuro-forca-motora':
                    showHide('neuro-forca-motora-detalhes-container', ['Paresia (localizar)', 'Plegia (localizar)'].includes(value));
                    break;
                case 'cardio-sopros':
                    showHide('cardio-sopros-detalhes-container', value !== 'Ausentes' && value !== '' && value !== 'outro');
                    break;
                case 'ra-resp':
                    showHide('ra-resp-detalhes-container', value !== 'Ausentes' && value !== '' && value !== 'outro');
                    break;
                case 'pele-integridade':
                    showHide('pele-integridade-detalhes-container', ['Com Lesões', 'Úlcera de Pressão'].includes(value));
                    break;
            }
        });

        // --- Geração de Resumo e Cópia ---
        // Adiciona um pequeno delay para capturar todas as mudanças e evitar recálculos excessivos
        let summaryTimeout;
        form.addEventListener('input', () => {
            clearTimeout(summaryTimeout);
            summaryTimeout = setTimeout(generateSummary, 200);
        });

        document.getElementById('copy-btn').addEventListener('click', () => {
            const textToCopy = document.getElementById('summary-output').innerText;
            navigator.clipboard.writeText(textToCopy).then(() => {
                const copyBtn = document.getElementById('copy-btn');
                const originalText = copyBtn.innerHTML;
                copyBtn.innerHTML = `<i class="fas fa-check mr-2"></i> Copiado!`;
                setTimeout(() => { copyBtn.innerHTML = originalText; }, 2000);
            }).catch(err => console.error('Falha ao copiar texto:', err));
        });

        // Gera o resumo inicial (com campos vazios)
        generateSummary();
    });

    // ====================================================================================
    // FUNÇÃO DE GERAÇÃO DE RESUMO - OTIMIZADA E OBJETIVA
    // ====================================================================================
    function generateSummary() {
        // --- FUNÇÕES HELPER ---
        const getInputValue = id => document.getElementById(id)?.value.trim() || '';
        const getSelectValue = id => document.getElementById(id)?.value || '';
        const getCheckboxStatus = id => document.getElementById(id)?.checked || false;

        // Processa selects que podem ter opção 'outro', retornando o valor ou 'outro (detalhes)'
        const processSelect = (id) => {
            const value = getSelectValue(id);
            if (value === 'outro') {
                return getInputValue(`${id}-outro`) ? `Outro (${getInputValue(`${id}-outro`)})` : 'Outro (não especificado)';
            }
            return value;
        };

        // Formata detalhes para campos como Força Motora e Sopros, substituindo placeholders ou adicionando detalhes
        const formatDetail = (selectId, detailId, placeholder, prefix = '') => {
            const value = getSelectValue(selectId);
            const detail = getInputValue(detailId);
            if (!value) return '';

            if (value.includes(placeholder) && detail) {
                return `${prefix}${value.replace(placeholder, `em ${detail}`)}`;
            } else if (value.includes(placeholder)) { // If placeholder exists but no detail, remove placeholder
                 return `${prefix}${value.replace(` (${placeholder})`, '')}`;
            }
            return `${prefix}${value}`;
        };

        let resumo = '';
        const addSection = (title, contentArray) => {
            if (contentArray && contentArray.length > 0) {
                // Ensure contentArray is flat for main sections, and nested for EF subsections
                const formattedContent = contentArray.map(item => {
                    // If an item itself contains newlines (e.g., for EF subsections), keep its formatting
                    if (item.includes('\n')) {
                        return item; // Already formatted as a sub-section
                    }
                    return `- ${item}`; // Standard list item
                }).join('\n');
                resumo += `${title}\n${formattedContent}\n\n`;
            }
        };

        // --- 1. SITUAÇÃO GERAL E ANAMNESE ---
        let anamneseItems = [];

        const setor = getInputValue('setor');
        const leito = getInputValue('leito');
        if (setor || leito) anamneseItems.push(`Localização: Setor ${setor || 'N/A'}, Leito ${leito || 'N/A'}`);

        const evolucaoClinica = getSelectValue('evolucao-clinica');
        if (evolucaoClinica) anamneseItems.push(`Evolução Clínica: ${evolucaoClinica}`);

        const evolucaoHemo = getSelectValue('evolucao-hemo');
        if (evolucaoHemo) anamneseItems.push(`Evolução Hemodinâmica: ${evolucaoHemo}`);

        const estadoGeral = getSelectValue('estado-geral');
        if (estadoGeral) anamneseItems.push(`Estado Geral: ${estadoGeral}`);

        const queixas = getSelectValue('queixas');
        if (queixas === 'Sim') anamneseItems.push(`Queixas nas 24h: Sim (${getInputValue('queixas-obs') || 'não especificadas'})`);
        else if (queixas === 'Não') anamneseItems.push(`Queixas nas 24h: Não`);

        const distermias = getSelectValue('distermias');
        if (distermias) anamneseItems.push(`Distermias: ${distermias}`);

        const disglicemias = getSelectValue('disglicemias');
        if (disglicemias) anamneseItems.push(`Disglicemias: ${disglicemias}`);

        const altPa = getSelectValue('alt-pa');
        if (altPa) anamneseItems.push(`Alterações de PA: ${altPa}`);

        const altLab = getSelectValue('alt-lab');
        if (altLab) anamneseItems.push(`Alterações Lab: ${altLab}`);

        const obsGeraisAnamnese = getInputValue('obs-gerais');
        if (obsGeraisAnamnese) anamneseItems.push(`Observações gerais: ${obsGeraisAnamnese}`);

        addSection('1. SITUAÇÃO GERAL E ANAMNESE', anamneseItems);

        // --- 2. PARÂMETROS VITAIS E SUPORTE ---
        let paramsItems = [];

        const vitais = [
            getInputValue('pa') && `PA: ${getInputValue('pa')} mmHg`,
            getInputValue('fc') && `FC: ${getInputValue('fc')} bpm`,
            getInputValue('fr') && `FR: ${getInputValue('fr')} irpm`,
            getInputValue('temp') && `Temp: ${getInputValue('temp')} °C`,
            getInputValue('sato2') && `SatO₂: ${getInputValue('sato2')}%`,
            getInputValue('dor-escala') && `Dor: ${getInputValue('dor-escala')}/10`
        ].filter(Boolean);
        if (vitais.length) paramsItems.push(`Dados Vitais: ${vitais.join(' | ')}`);

        const suporteVent = getSelectValue('suporte-vent');
        if (suporteVent) {
            let ventDetails = processSelect('suporte-vent');
            if (suporteVent === 'VM') {
                const vmParams = [
                    getInputValue('vm-modo') && `Modo: ${getInputValue('vm-modo')}`,
                    getInputValue('vm-fio2') && `FiO₂: ${getInputValue('vm-fio2')}%`,
                    getInputValue('vm-peep') && `PEEP: ${getInputValue('vm-peep')} cmH₂O`,
                    getInputValue('vm-fr') && `FR: ${getInputValue('vm-fr')} irpm`,
                    getInputValue('vm-pva') && `Pva: ${getInputValue('vm-pva')} cmH₂O`,
                    getInputValue('vm-tidal-vol') && `VT: ${getInputValue('vm-tidal-vol')} mL`,
                    getInputValue('vm-outros-params') && `Outros: ${getInputValue('vm-outros-params')}`
                ].filter(Boolean);
                if (vmParams.length) ventDetails += ` (${vmParams.join(', ')})`;
            }
            paramsItems.push(`Ventilação: ${ventDetails}`);
        }

        const dvaStatus = getSelectValue('dva');
        if (dvaStatus === 'Sim') paramsItems.push(`Uso de DVA: Sim (${getInputValue('dva-obs') || 'não especificada'})`);
        else if (dvaStatus === 'Não') paramsItems.push(`Uso de DVA: Não`);

        const dieta = processSelect('dieta-tipo');
        if (dieta) {
            let dietaText = `Dieta: ${dieta}`;
            if (dieta.toLowerCase() !== 'jejum' && getSelectValue('dieta-tipo') !== 'Jejum') { // Check original select value for 'Jejum'
                const aceitacao = getSelectValue('dieta-aceitacao');
                if (aceitacao) dietaText += ` (Aceitação: ${aceitacao})`;
            }
            paramsItems.push(dietaText);
        }

        const diureseTipo = processSelect('diurese-tipo');
        const diureseQtde = getInputValue('diurese');
        if (diureseTipo) paramsItems.push(`Diurese: ${diureseTipo}${diureseQtde ? ` (${diureseQtde} mL/24h)` : ''}`);

        const evacuacoesTipo = processSelect('evacuacoes-tipo');
        const evacuacoesQtde = getInputValue('evacuacoes');
        if (evacuacoesTipo) paramsItems.push(`Evacuações: ${evacuacoesTipo}${evacuacoesQtde ? ` (${evacuacoesQtde}x/24h)` : ''}`);

        // Picos e Eventos
        let picosEventos = [];
        const addPicoEvento = (label, valueId, hourId) => {
            const value = getInputValue(valueId);
            const hour = getInputValue(hourId);
            if (value) picosEventos.push(`${label} ${value}${hour ? ` às ${hour}` : ''}`);
        };

        addPicoEvento('Pico PA', 'pico-pa', 'pico-pa-hora');
        addPicoEvento('Queda PA', 'queda-pa', 'queda-pa-hora');
        addPicoEvento('Pico Temp', 'pico-temp', 'pico-temp-hora');
        addPicoEvento('Queda Temp', 'queda-temp', 'queda-temp-hora');
        addPicoEvento('Pico Glicêmico', 'pico-glicemia', 'pico-glicemia-hora');
        addPicoEvento('Queda Glicêmica', 'queda-glicemia', 'queda-glicemia-hora');
        addPicoEvento('Pico SatO₂', 'pico-sato2', 'pico-sato2-hora');
        addPicoEvento('Queda SatO₂', 'queda-sato2', 'queda-sato2-hora');

        if (picosEventos.length) paramsItems.push(`Picos e Eventos nas 24h: ${picosEventos.join(', ')}`);

        addSection('2. PARÂMETROS VITAIS E SUPORTE', paramsItems);

        // --- 3. EXAME FÍSICO ---
        let exameFisicoContent = []; // Este será um array de subseções formatadas

        const addSubSectionToList = (title, itemsArray) => {
            if (itemsArray && itemsArray.length > 0) {
                exameFisicoContent.push(`${title.toUpperCase()}\n${itemsArray.map(item => `  - ${item}`).join('\n')}`);
            }
        };

        // Geral
        let geralItems = [];
        const efAparenciaGeral = processSelect('ef-aparencia-geral');
        if (efAparenciaGeral) geralItems.push(`Aparência Geral: ${efAparenciaGeral}`);

        const efFacies = processSelect('ef-facies');
        if (efFacies) geralItems.push(`Expressão Facial / Fácies: ${efFacies}`);

        const efDesconforto = processSelect('ef-desconforto');
        if (efDesconforto) geralItems.push(`Sinais de Desconforto/Sofrimento: ${efDesconforto}`);

        const efContato = processSelect('ef-contato');
        if (efContato) geralItems.push(`Contato / Interação: ${efContato}`);

        const geralNutri = processSelect('ef-estado-nutricional');
        if (geralNutri) geralItems.push(`Estado Nutricional: ${geralNutri}`);

        const geralDecub = processSelect('ef-decubito');
        if (geralDecub) geralItems.push(`Decúbito/Mobilidade: ${geralDecub}`);

        const efDispositivos = getInputValue('ef-dispositivos');
        if (efDispositivos) geralItems.push(`Dispositivos: ${efDispositivos}`);

        const geralAdj = [
            getCheckboxStatus('ef-corado') && 'Corado',
            getCheckboxStatus('ef-hidratado') && 'Hidratado',
            getCheckboxStatus('ef-anictérico') && 'Anictérico',
            getCheckboxStatus('ef-acianotico') && 'Acianótico',
            getCheckboxStatus('ef-afebril') && 'Afebril',
            getCheckboxStatus('ef-eupneico') && 'Eupnéico'
        ].filter(Boolean);
        if (geralAdj.length) geralItems.push(`Aspectos Gerais: ${geralAdj.join(', ')}`);

        const efGeralObs = getInputValue('ef-geral-obs');
        if (efGeralObs) geralItems.push(`Outras Observações: ${efGeralObs}`);
        addSubSectionToList('Geral', geralItems);

        // Neurológico
        let neuroItems = [];
        const neuroConsc = processSelect('neuro-consciencia-ef');
        if (neuroConsc) neuroItems.push(`Nível de Consciência: ${neuroConsc}`);

        const rass = getSelectValue('neuro-rass');
        if (rass) neuroItems.push(`RASS: ${rass}`);

        const glasgow = getInputValue('glasgow');
        if (glasgow) neuroItems.push(`Glasgow: ${glasgow}`);

        const pupilas = processSelect('neuro-pupilas');
        if (pupilas) neuroItems.push(`Pupilas: ${pupilas}`);

        const pares = getSelectValue('neuro-pares');
        if (pares === 'Alterados') neuroItems.push(`Pares Cranianos: Alterados (${getInputValue('neuro-pares-detalhes') || 'não especificado'})`);
        else if (pares && pares !== 'outro') neuroItems.push(`Pares Cranianos: ${pares}`);
        else if (getInputValue('neuro-pares-outro')) neuroItems.push(`Pares Cranianos: Outro (${getInputValue('neuro-pares-outro')})`);

        const forca = formatDetail('neuro-forca-motora', 'neuro-forca-motora-detalhes', '(localizar)', 'Força Motora: ');
        if (forca) neuroItems.push(forca);
        else if (getSelectValue('neuro-forca-motora') && getSelectValue('neuro-forca-motora') !== 'outro') neuroItems.push(`Força Motora: ${getSelectValue('neuro-forca-motora')}`);
        else if (getInputValue('neuro-forca-motora-outro')) neuroItems.push(`Força Motora: Outro (${getInputValue('neuro-forca-motora-outro')})`);


        const sensibilidade = processSelect('neuro-sensibilidade');
        if (sensibilidade) neuroItems.push(`Sensibilidade: ${sensibilidade}`);

        const reflexos = processSelect('neuro-reflexos');
        if (reflexos) neuroItems.push(`Reflexos: ${reflexos}`);

        const meningeos = getSelectValue('neuro-meningeos');
        if (meningeos) neuroItems.push(`Sinais Meníngeos: ${meningeos}`);

        const neuroObs = getInputValue('neuro-obs');
        if (neuroObs) neuroItems.push(`Observações: ${neuroObs}`);
        addSubSectionToList('Neurológico', neuroItems);

        // Cardiovascular
        let cardioItems = [];
        const ritmo = processSelect('cardio-ritmo');
        if (ritmo) cardioItems.push(`Ritmo: ${ritmo}`);

        const bulhas = processSelect('cardio-bulhas');
        const tempos = processSelect('cardio-bulhas-tempos');
        if (bulhas || tempos) cardioItems.push(`Bulhas: ${bulhas || 'N/A'}${tempos ? ` ${tempos}` : ''}`);

        const sopro = getSelectValue('cardio-sopros');
        if (sopro === 'Ausentes') cardioItems.push(`Sopros: Ausentes`);
        else if (sopro && sopro !== 'outro') cardioItems.push(`Sopros: ${formatDetail('cardio-sopros', 'cardio-sopros-detalhes', 'Sopro')}`);
        else if (getInputValue('cardio-sopros-outro')) cardioItems.push(`Sopros: Outro (${getInputValue('cardio-sopros-outro')})`);

        const tj = processSelect('cardio-tj');
        if (tj) cardioItems.push(`Turgência Jugular: ${tj}`);

        const ictus = processSelect('cardio-ictus');
        if (ictus) cardioItems.push(`Ictus: ${ictus}`);

        const efCardioObs = getInputValue('ef-cardio-obs');
        if (efCardioObs) cardioItems.push(`Observações: ${efCardioObs}`);
        addSubSectionToList('Cardiovascular', cardioItems);

        // Respiratório
        let respItems = [];
        const respPadrao = processSelect('resp-padrao');
        if (respPadrao) respItems.push(`Padrão Respiratório: ${respPadrao}`);

        const auscultaResp = processSelect('ausculta-resp');
        if (auscultaResp) respItems.push(`Ausculta Pulmonar: ${auscultaResp}`);

        const ra = getSelectValue('ra-resp');
        if (ra === 'Ausentes') respItems.push(`Ruídos Adventícios: Ausentes`);
        else if (ra && ra !== 'outro') respItems.push(`Ruídos Adventícios: ${formatDetail('ra-resp', 'ra-resp-detalhes', 's')}`);
        else if (getInputValue('ra-resp-outro')) respItems.push(`Ruídos Adventícios: Outro (${getInputValue('ra-resp-outro')})`);

        const efRespDispneia = processSelect('ef-resp-dispneia');
        if (efRespDispneia) respItems.push(`Dispneia: ${efRespDispneia}`);

        const efRespTosseGeral = getSelectValue('ef-resp-tosse-geral');
        if (efRespTosseGeral === 'Sim') {
            const tipoTosse = processSelect('ef-resp-tosse');
            respItems.push(`Tosse: Sim (${tipoTosse}${getInputValue('ef-resp-tosse-outro') ? `, ${getInputValue('ef-resp-tosse-outro')}` : ''})`);
        } else if (efRespTosseGeral === 'Não') {
            respItems.push(`Tosse: Não`);
        }

        const efRespObs = getInputValue('ef-resp-obs');
        if (efRespObs) respItems.push(`Observações: ${efRespObs}`);
        addSubSectionToList('Respiratório', respItems);

        // Abdominal
        let abdItems = [];
        const formaAbd = processSelect('ef-abd-forma');
        if (formaAbd) abdItems.push(`Forma: ${formaAbd}`);

        const consistenciaAbd = processSelect('ef-abd-consistencia');
        if (consistenciaAbd) abdItems.push(`Consistência: ${consistenciaAbd}`);

        const dorAbd = processSelect('ef-abd-dor');
        if (dorAbd) abdItems.push(`Dor à Palpação: ${dorAbd}`);

        const viscero = getSelectValue('ef-abd-viscero');
        if (viscero === 'Ausentes') abdItems.push(`Visceromegalias: Ausentes`);
        else if (viscero && viscero !== 'outro') abdItems.push(`Visceromegalias: ${viscero}`);
        else if (getInputValue('ef-abd-viscero-outro')) abdItems.push(`Visceromegalias: Outro (${getInputValue('ef-abd-viscero-outro')})`);

        const efAbdSons = processSelect('ef-abd-sons');
        if (efAbdSons) abdItems.push(`Ruídos Hidroaéreos: ${efAbdSons}`);

        const efAbdObs = getInputValue('ef-abd-obs');
        if (efAbdObs) abdItems.push(`Observações: ${efAbdObs}`);
        addSubSectionToList('Abdominal', abdItems);

        // Pele e Periférico
        let peleItems = [];
        const peleTemp = processSelect('pele-temp');
        if (peleTemp) peleItems.push(`Temperatura: ${peleTemp}`);

        const peleTurgor = processSelect('pele-turgor');
        if (peleTurgor) peleItems.push(`Turgor: ${peleTurgor}`);

        const peleEdema = getSelectValue('pele-edema');
        if (peleEdema === 'Presente') peleItems.push(`Edema: Presente (${getInputValue('pele-edema-detalhes') || 'não especificado'})`);
        else if (peleEdema === 'Ausente') peleItems.push(`Edema: Ausente`);

        const peleTec = processSelect('pele-tec');
        if (peleTec) peleItems.push(`Perfusão Capilar: ${peleTec}`);

        const pelePulsos = processSelect('pele-pulsos');
        if (pelePulsos) peleItems.push(`Pulsos: ${pelePulsos}`);

        const peleIntegridade = getSelectValue('pele-integridade');
        if (peleIntegridade === 'Íntegra') peleItems.push(`Integridade da Pele: Íntegra`);
        else if (['Úlcera de Pressão', 'Com Lesões'].includes(peleIntegridade)) peleItems.push(`Integridade da Pele: ${peleIntegridade} (${getInputValue('pele-integridade-detalhes') || 'não descrito'})`);
        else if (peleIntegridade && peleIntegridade !== 'outro') peleItems.push(`Integridade da Pele: ${peleIntegridade}`);
        else if (getInputValue('pele-integridade-outro')) peleItems.push(`Integridade da Pele: Outro (${getInputValue('pele-integridade-outro')})`);


        const peleObs = getInputValue('pele-obs');
        if (peleObs) peleItems.push(`Observações: ${peleObs}`);
        addSubSectionToList('Pele e Periférico', peleItems);

        // Outro Sistema
        const outroSistemaNome = getInputValue('ef-outro-sistema-nome');
        const outroSistemaDesc = getInputValue('ef-outro-sistema-descricao');
        if (outroSistemaNome && outroSistemaDesc) {
            addSubSectionToList(outroSistemaNome.toUpperCase(), [outroSistemaDesc]);
        }

        // Adiciona todas as subseções do exame físico como um bloco
        addSection('3. EXAME FÍSICO', exameFisicoContent);

        // --- SEÇÕES FINAIS (FORMATO DE LISTA É APROPRIADO) ---
        const createListSection = (title, items) => {
            const content = items.map(item => item.value ? `- ${item.label}: ${item.value}` : null).filter(Boolean);
            addSection(title, content);
        };

        createListSection('4. INTERCORRÊNCIAS E CONDUTAS', [
            { label: 'Intercorrências Clínicas', value: getInputValue('intercorrencias') },
            { label: 'Ajustes Terapêuticos / Prescrições', value: getInputValue('ajustes') }
        ]);

        createListSection('5. EXAMES E RESULTADOS', [
            { label: 'Laboratoriais', value: getInputValue('exames-lab') },
            { label: 'De Imagem', value: getInputValue('exames-imagem') },
            { label: 'Outros', value: getInputValue('exames-outros') }
        ]);

        createListSection('6. CONDUTA E PLANEJAMENTO', [
            { label: 'Conduta para as Próximas 24 horas', value: getInputValue('conduta') },
            { label: 'Outras Considerações', value: getInputValue('planejamento') },
            { label: 'Profilaxias (TVP/TEV, Úlcera de Estresse)', value: getInputValue('profilaxias') }
        ]);

        // --- Final Output ---
        const outputElement = document.getElementById('summary-output');
        outputElement.innerText = resumo.trim() ? resumo.trim() : 'Comece a preencher os campos para gerar o resumo.';
    }
</script>


</body>
</html>
